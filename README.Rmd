---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# welfarebR

<!-- badges: start -->
[![R-CMD-check](https://github.com/SidneyBissoli/welfarebR/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/SidneyBissoli/welfarebR/actions/workflows/R-CMD-check.yaml)
<!-- badges: end -->

welfarebR provides functions to download and process Brazilian social assistance data in tidy format. The package gives easy access to data from:
- **Censo SUAS**: Annual census of the Unified Social Assistance System (CRAS, CREAS, Municipal Management)
- **CadUnico**: Deidentified sample from the Unified Registry for Social Programs

Data sources are from the Ministry of Social Development (MDS).

## Installation
You can install the development version of welfarebR from GitHub:

```{r eval=FALSE}
# install.packages("pak")
pak::pak("SidneyBissoli/welfarebR")

# or using remotes
# install.packages("remotes")
remotes::install_github("SidneyBissoli/welfarebR")
```

## Usage

### Censo SUAS

```{r eval=FALSE}
library(welfarebR)

# list available datasets
available_censo_suas()

# download CRAS data for 2017
cras_2017 <- get_censo_suas(year = 2017, questionnaire = "cras")

# download only for Sao Paulo state
cras_sp <- get_censo_suas(year = 2017, questionnaire = "cras", uf = "SP")

# get variable dictionary
dict <- dictionary_censo_suas(year = 2017, questionnaire = "cras")
```

### CadUnico

```{r eval=FALSE}
# list available years
available_cadunico()

# download CadUnico sample for 2018
cad_2018 <- get_cadunico(year = 2018)

# download as survey design object (for proper weighted analysis)
cad_survey <- get_cadunico(year = 2018, as_survey = TRUE)

# example: calculate weighted statistics
library(srvyr)
cad_survey |>
  summarise(mean_income = survey_mean(renda_per_capita, na.rm = TRUE))
```

### Cache

Data is cached locally by default to avoid repeated downloads:

```{r eval=FALSE}
# check cache directory
get_cache_dir()

# set custom cache directory
set_cache_dir("~/my_cache")

# clear cache
clear_welfarebr_cache()
```

## Data sources

| Dataset | Description | Years | Source |
|---------|-------------|-------|--------|
| Censo SUAS | Census of social assistance units | 2011-2017 | MDS/SAGI |
| CadUnico | Unified Registry sample | 2012-2018 | MDS/SAGI |

## Contributing

Contributions are welcome! Please open an issue or submit a pull request on [GitHub](https://github.com/SidneyBissoli/welfarebR).

## License

MIT
